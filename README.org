# Author: Claudio <3261958605@qq.com>
# Created: 2017-07-04 17:33:08
# Commentary:
#+TITLE: 山东高速集团四川产业运营公司鲜活车处理系统

* 功能

  批量重命名鲜活车照片，自动填写Excel表单中的部分内容。

* 获取方式

  [[http://pan.baidu.com/s/1qYDKMOO][百度网盘]]

* 用法

  1. 选择“鲜活车常过车道”。（用于填写Excel表单）

  2. 分别选择“待处理照片所在文件夹”、“照片处理后放置文件夹”和“需操作的
     Excel文件”。

  3. 上述选择完成后，点击“开始”。计算过程中所有可交互的界面会呈灰色，
     待计算完成后恢复。

* *注意事项*

  1. *相机需有记录拍照时间的功能，且调至与车道时间同步。*

  2. Excel文件需为“*.xlsx”文件，不支持“*.xls”文件。

  3. Excel文件中共需12个表单，单月数据放在单个表单中。

  4. Excel文件中的表单名称为“7月”形式，即“月份数字+‘月’”。

  5. 如果为新创建的Excel表单，需手动更改格式。

  6. Excel表单中前3行的格式需为：

     #+BEGIN_QUOTE
     收费站鲜活车登记表
     单位：XX收费站
     序号 日期 时间 车道 车牌 车型 农产品种类 操作人 照片索引 备注
     #+END_QUOTE

  7. 其它行中，每行信息分别为如下格式：

     #+BEGIN_QUOTE
     123   2017.07.01   17:16:03  车道编号（数字）  川C12345 车型（数字） 水果 收费员名字 20170701005.1-005.3
     #+END_QUOTE

     在现有的表单中：

     # *其中“日期”列需为插入的日期，而非直接输入的日期。*

     其中“日期”、“时间”和“照片索引”需严格按上面格式，否则会造成读取信
     息错误，写入时出现混乱。

  # 7. 如果有照片丢失，新添加的照片需重命名为“2017-07-28-13-02-02+后缀”
  #    形式，即“年-月-日-时-分-秒.后缀”。确定时间的方法为该照片本来应该
  #    拍摄的时间。

* 更新记录

** Version0.3.3.2

   1. 添加恢复上次配置功能。

** Version0.3.3.1

   1. 修复bug：如果表单最后有以前输入的内容（内容为空，有样式），遍历
      表单后，如果没有前一天车辆记录，会将新增记录插入到空白行后。

** Version0.3.3

   1. 修复bug：当前文件夹中修改后，在当前文件夹中新增照片组，再操作误
      删照片。
   2. 修复bug：不能跨月操作Excel表单，获取昨天已经编辑车辆个数。
   3. 将可执行程序所在文件夹改名为“鲜活车处理系统”（修改build.bat）
   4. “鲜活车常过车道”可选范围改为：1-20。
   5. Excel表单中，“车牌栏”自动添加“川”。

** Version: 0.3.2

   1. 新增自动添加Excel表格功能。
   2. 照片排序由“按名称”变为“按拍摄时间”排序。
   3. 选择文件（文件夹）按钮添加图标。
   4. 如果有照片丢失，新增照片插入时命名方式有变化：
   5. 各部件代码重新分离。

** Version: 0.3.1

   1. 添加使用说明超链接。
   2. 去除“昨天（已）编辑车辆”默认禁用状态。
   3. 添加Logo。
   4. 修改“处理中...”显示时间。
   5. 重命名时禁用所有交互，完成后恢复。
   6. 默认在当前文件夹中修改（使用需谨慎）。

** Version: 0.3

   1. 使用多线程加快运行速度。
   2. 去除进度条，以消息显示代替。
   3. 代码中将功能函数单独分离为utils.py文件。

** Version：0.2

   1. 添加选择跳过昨天车辆数功能。

* TODO 待解决（不要有太高期望）
  # ** 自动识别车牌
** 可修改单个车的3张照片，实现“车头->车身->车尾”排序

   1. 选择操作车辆的索引
   2. 选择另外5种排序可能中的一种
